(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/FeatureLayerView2D":2126,"esri/views/2d/layers/LayerView2D":2178,"esri/renderers/support/clickToleranceUtils":2187,"esri/views/2d/layers/support/popupUtils2D":2216,"esri/views/2d/layers/features/support/rendererUtils":2324,"esri/views/2d/layers/features/tileRenderers":2472,"esri/views/2d/layers/support/FeatureLayerProxy":2473,"esri/views/2d/layers/support/util":2474})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{2126:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(76),r(4),r(9),r(11),r(135),r(116),r(35),r(62),r(58),r(47),r(31),r(15),r(26),r(13),r(14),r(7),r(60),r(29),r(2),r(2187),r(93),r(163),r(2118),r(2178),r(2472),r(2324),r(2473),r(2216),r(2474),r(822),r(2325),r(808),r(2326)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,c,p,h,d,f,y,v,g,_,b,m,R,w,S,x,O,q,F,I,P,C,V,M,E,j,H,T){var U=g.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._pipelineIsUpdating=!0,t._updatingPipelineConfig=!1,t._visibilityOverrides=new l.default,t._effect=null,t._highlightIDs=new l.default,t._highlightRequested=!1,t._outstandingIdRequests=0,t.container=new q.Container,t.filter=null,t._onRenderingConfigChange=b.debounce(d.safeCastFunction(function(){return a(t,void 0,void 0,function(){var e,t,r,i,n,o,a,u,l,c,p;return s(this,function(s){switch(s.label){case 0:return this._hasRequiredSupport(this.layer)?(this._set("_updatingPipelineConfig",!0),e=this._createLayerFilterHash(),t=this._createTileRendererHash(),r=this._createFeatureDataHash(),i=this._createMeshHash(),[4,this._updateRequiredFields()]):[2];case 1:return s.sent(),t===this._tileRendererHash?[3,8]:[4,this._initTileRenderer()];case 2:return s.sent(),function(e){return e&&"openPorts"in e}(this.layer.source)?[4,this._createMemoryServiceOptions(this.layer.source)]:[3,4];case 3:return o=s.sent(),[3,5];case 4:o=this._createServiceOptions(),s.label=5;case 5:return n=o,[4,this._proxy.startup(this.view.featuresTilingScheme,this._createConfiguration(),n)];case 6:return s.sent(),[4,this._onceTilesUpdated()];case 7:return s.sent(),[3,13];case 8:return a=e!==this._layerFilterHash,u=r!==this._featureDataHash,l=i!==this._meshHash,c=this._createConfiguration(),a||u||l?(p={invalidateFeatureData:u,invalidateMesh:l,layerFilterChanged:a},[4,this._proxy.update(c,p)]):[3,10];case 9:s.sent(),s.label=10;case 10:return a?[4,this._onceTilesUpdated()]:[3,12];case 11:s.sent(),s.label=12;case 12:this.tileRenderer.onConfigUpdate(),s.label=13;case 13:return this._layerFilterHash=e,this._tileRendererHash=t,this._meshHash=i,this._featureDataHash=r,this.effects.forEach(function(e){return _.isSome(e)&&_.isSome(e.filter)&&e.filter.enable()}),this.tileRenderer.invalidateLabels(),this.requestUpdate(),[2]}})})})),t}return r(t,e),t.prototype.destroy=function(){this._proxy.destroy()},t.prototype.initialize=function(){this.addResolvingPromise(d.safeCast(this._initProxy()))},t.prototype._initProxy=function(){return a(this,void 0,void 0,function(){var e;return s(this,function(t){if(this.layer.isTable)throw new y("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});return this._proxy&&this._proxy.destroy(),e=this._createClientOptions(),this._proxy=new C.default({client:e}),[2,this._proxy.when()]})})},Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){return _.unwrapOr(this._effect,null)},set:function(e){var t=this._effect;_.isSome(t)&&_.isSome(t.filter)&&t.filter.enabled&&_.isSome(e)&&_.isSome(e.filter)&&e.filter.enable(),this._effect=e,this.notifyChange("effect")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numFeatures",{get:function(){var e=0;return this.attached&&this._tileStrategy.tiles.forEach(function(t){e+=t.iconDisplayRecords?t.iconDisplayRecords.length:0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var e=this.availableFields,t=this.layer,r=t.definitionExpression,i=t.renderer,n=t.labelingInfo,o="historicMoment"in this.layer?this.layer.historicMoment:null,s=this.timeExtent,a="filter"in this.layer&&this.layer.filter&&""+JSON.stringify(this.layer.filter.geometry)+this.layer.filter.where;return JSON.stringify({filterHash:_.isSome(this.filter)&&this.filter.toJSON(),effectHash:_.isSome(this.effect)&&this.effect.toJSON(),streamFilter:a,definitionExpression:r,historicMoment:o,availableFields:e,renderer:i,labelingInfo:n,timeExtent:s})},enumerable:!0,configurable:!0}),t.prototype.highlight=function(e){var t,r=this;return e instanceof p?t=[e.getAttribute(this.layer.objectIdField||"__esri_stream_id__")]:"number"==typeof e?t=[e]:f.isCollection(e)?t=e.map(function(e){return e&&e.getAttribute(r.layer.objectIdField)}).toArray():Array.isArray(e)&&e.length>0&&(t="number"==typeof e[0]?e:e.map(function(e){return e&&e.getAttribute(r.layer.objectIdField)})),(t=t.filter(function(e){return null!=e})).length&&this._addHighlight(t),{remove:function(){return r._removeHighlight(t)},pause:function(){return r._removeHighlight(t)},resume:function(){return r._addHighlight(t)}}},t.prototype.getLocalIdsToHighlight=function(){return a(this,void 0,void 0,function(){var e,t,r,i,n;return s(this,function(o){switch(o.label){case 0:if(e=[],!this.hasHighlight())return[2,{isEmpty:!0,has:function(e){return!1}}];this._set("_outstandingIdRequests",this._outstandingIdRequests+1),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._proxy.mapValidLocalIds(u.from(this._highlightIDs))];case 2:return e=o.sent(),[3,4];case 3:return o.sent(),v("esri-2d-debug")&&console.debug("Unable to map valid local Ids"),[3,4];case 4:for(this._set("_outstandingIdRequests",this._outstandingIdRequests-1),t=new l.default,r=0,i=e;r<i.length;r++)n=i[r],t.add(n);return[2,{isEmpty:0===t.size,has:function(e){return t.has(e)}}]}})})},t.prototype.hasHighlight=function(){return!!this._highlightIDs.size},t.prototype.hitTest=function(e,t){return d.safeCast(this._hitTest(e,t))},t.prototype.queryFeatures=function(e,t){var r=this;return this.queryFeaturesJSON(e,t).then(function(e){var t=x.fromJSON(e);return t.features.forEach(function(e){e.layer=r.layer,e.sourceLayer=r.layer}),t})},t.prototype.queryFeaturesJSON=function(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)},t.prototype.queryObjectIds=function(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)},t.prototype.queryFeatureCount=function(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)},t.prototype.queryExtent=function(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then(function(e){return{count:e.count,extent:c.Extent.fromJSON(e.extent)}})},t.prototype.setVisibility=function(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._renderingConfigHashChanged()},t.prototype.update=function(e){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(e)||this.requestUpdate(),this._proxy.setViewState(e.state),this.notifyChange("numFeatures"),this.notifyChange("updating"))},t.prototype.attach=function(){var e=this;this._tileStrategy=new E({cachePolicy:"purge",acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add([R.watch(this,"layer.processing?.version",function(t){return e._proxy.redraw()}),this.layer.on("edits",function(t){return e._proxy.onEdits(t)}),R.init(this,"renderingConfigHash",function(){return e._renderingConfigHashChanged()})],"attach")},t.prototype.detach=function(){this.container.removeAllChildren(),this.handles.remove("attach"),this._updatingPipelineConfig=!1,this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.fetchPopupFeatures=function(e,t){return a(this,void 0,void 0,function(){var r,i,n;return s(this,function(o){return(r=this.validateFetchPopupFeatures(t))?[2,b.reject(r)]:(i=this.fetchClientPopupFeatures(t),e?(n=this._fetchServicePopupFeatures(e,t),[2,b.eachAlwaysValues([i,n]).then(h.flatten)]):[2,i])})})},t.prototype._fetchServicePopupFeatures=function(e,t){return a(this,void 0,void 0,function(){var r,i,n,o,a,u,c,p,h,d;return s(this,function(s){switch(s.label){case 0:return[4,this.createPopupQuery(t)];case 1:if(r=s.sent(),i=this.layer,n=i.renderer,o=S.calculateTolerance(n),r.geometry=this.createFetchPopupFeaturesQueryGeometry(e,o),a=new l.default,u=i.objectIdField,c=_.isSome(t)?t.clientGraphics:null)for(p=0,h=c;p<h.length;p++)d=h[p],a.add(d.attributes[u]);return[2,i.queryFeatures(r).then(function(e){return e.features.filter(function(e){return!a.has(e.attributes[u])})})]}})})},t.prototype.createFetchPopupFeaturesQueryGeometry=function(e,t){return V.createQueryGeometry(e,t,this.view)},t.prototype.doRefresh=function(e){return a(this,void 0,void 0,function(){return s(this,function(e){return this._proxy.refresh(),[2]})})},t.prototype.isUpdating=function(){return null!=this.layer.renderer&&(null==this.tileRenderer||0!==this._outstandingIdRequests||this._pipelineIsUpdating||this._updatingPipelineConfig||this.tileRenderer.updating)},t.prototype._createClientOptions=function(){var e=this;return{executeProcessing:function(t){if(!("processing"in e.layer&&e.layer.processing))return t.featureSet;var r=e.layer.processing;return r.process(t.featureSet,r.options)||b.reject(new y("FeatureLayer","invalid processing.process() method, returns nothing"))},setUpdating:function(t){e._set("_pipelineIsUpdating",t)}}},t.prototype._createServiceOptions=function(){var e=this.layer,t=e.capabilities,r=e.objectIdField,i=e.fields.map(function(e){return e.toJSON()}),n=e.fullExtent&&e.fullExtent.toJSON(),o=M.toJSONGeometryType(e.geometryType),s=e.timeInfo&&e.timeInfo.toJSON()||null;return{type:"on-demand",maxRecordCount:"maxRecordCount"in this.layer&&this.layer.maxRecordCount,tileMaxRecordCount:"tileMaxRecordCount"in this.layer&&this.layer.tileMaxRecordCount,capabilities:t,fields:i,fullExtent:n,geometryType:o,objectIdField:r,source:"dynamicDataSource"in e?e.dynamicDataSource?e.parsedUrl:e.url+"/"+e.layerId:e.parsedUrl,timeInfo:s}},t.prototype._createMemoryServiceOptions=function(e){return a(this,void 0,void 0,function(){var t;return s(this,function(r){switch(r.label){case 0:return[4,e.openPorts()];case 1:return t=r.sent(),[2,o({},this._createServiceOptions(),{type:"memory",source:t})]}})})},t.prototype._cleanUpQuery=function(e){var t=O.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t},t.prototype._acquireTile=function(e){var t=this,r=this.tileRenderer.acquireTile(e);return r.once("attach",function(){t.requestUpdate()}),r},t.prototype._releaseTile=function(e){this.tileRenderer.releaseTile(e)},t.prototype._initTileRenderer=function(){return a(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,I.createOrReuseTileRenderer(this.tileRenderer,this.layer.renderer,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer})];case 1:return e=t.sent(),this.tileRenderer?(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null,[4,this._initProxy()]):[3,3];case 2:t.sent(),t.label=3;case 3:return this.tileRenderer=this._proxy.tileRenderer=e,this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(),[2,this.tileRenderer]}})})},t.prototype._createLayerFilterHash=function(){return this.layer.definitionExpression+"."+(("feature"===this.layer.type||"csv"===this.layer.type)&&this.layer.historicMoment&&this.layer.historicMoment.getTime())+"."+(("feature"===this.layer.type||"csv"===this.layer.type)&&this.layer.gdbVersion)},t.prototype._createTileRendererHash=function(){return("heatmap"===this.layer.renderer.type?"heatmap":"symbol")+"."+("dot-density"===this.layer.renderer.type)},t.prototype._createFeatureDataHash=function(){var e=this.layer.renderer.getAttributeHash(),t=JSON.stringify(this.filter),r=_.isSome(this.effect)&&JSON.stringify(this.effect.filter),i=JSON.stringify(this.timeExtent),n="";return this._visibilityOverrides.forEach(function(e){return n+=e}),e+"."+t+"."+r+"."+i+"."+n},t.prototype._createMeshHash=function(){var e=this.layer.renderer,t=q.getVVFlags("visualVariables"in e&&e.visualVariables||[]),r=this.layer.labelingInfo&&this.layer.labelingInfo.map(function(e){return JSON.stringify(e)}).join("/");return e.getMeshHash()+"."+t+"."+r},t.prototype._injectOverrides=function(e){var t=this.filter&&this.filter.timeExtent,r=this.timeExtent&&t?this.timeExtent.intersection(t):this.timeExtent||t;if(!this._visibilityOverrides.size&&!r)return e;var i=_.isSome(this.filter)&&this.filter.clone()||new H;return i.hiddenIds=this._visibilityOverrides,i.timeExtent=r,i},t.prototype._createConfiguration=function(){var e=P.simplifyVVRenderer(this.layer.renderer),t=this.layer.labelingInfo,r=("feature"===this.layer.type||"csv"===this.layer.type)&&this.layer.historicMoment&&this.layer.historicMoment.getTime(),i=("feature"===this.layer.type||"csv"===this.layer.type)&&this.layer.gdbVersion,n=new Array(q.definitions.MAX_FILTERS),o=this._injectOverrides(this.filter);return n[0]=_.isSome(o)&&o.toJSON()||null,n[1]=_.isSome(this.effect)&&this.effect.filter&&this.effect.filter.toJSON()||null,{definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,labelingInfo:t&&t.map(function(e){return e.toJSON()}),renderer:e.toJSON(),gdbVersion:i,historicMoment:r,devicePixelRatio:window.devicePixelRatio||1,filters:n,processing:"processing"in this.layer&&this.layer.processing&&this.layer.processing.toWorker()}},t.prototype._hasRequiredSupport=function(e){return!("dot-density"===e.renderer.type&&!v("esri-webgl-texture-float")&&(U.error(new y("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),1))},t.prototype._onceTilesUpdated=function(){return this.requestUpdate(),R.once(this,"_pipelineIsUpdating")},t.prototype._renderingConfigHashChanged=function(){var e=this,t=this._onRenderingConfigChange();this._updatingPromise=t;var r=function(){return t===e._updatingPromise&&e._set("_updatingPipelineConfig",!1)};t.then(r).catch(function(e){b.isAbortError(e)||U.error(e),r()})},t.prototype._requestHighlight=function(){var e=this;this._highlightRequested||(this._highlightRequested=!0,m.schedule(function(){e.tileRenderer&&"updateHighlight"in e.tileRenderer&&e.tileRenderer.updateHighlight(),e._highlightRequested=!1}))},t.prototype._addHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._highlightIDs.add(i)}this._requestHighlight()},t.prototype._removeHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._highlightIDs.delete(i)}this._requestHighlight()},t.prototype._hitTest=function(e,t){return a(this,void 0,void 0,function(){var r,i,n,o,a=this;return s(this,function(s){switch(s.label){case 0:return this.suspended||!this.tileRenderer?[2,null]:[4,this.tileRenderer.hitTest(e,t)];case 1:return 0===(r=s.sent()).length?[2,null]:[4,b.all(r.map(function(e){return a._proxy.getObjectId(e)}))];case 2:return i=s.sent(),[4,this._proxy.queryFeatures(new O({objectIds:i,outSpatialReference:this.view.spatialReference,returnGeometry:!0}))];case 3:return(n=s.sent()).features[0]?((o=p.fromJSON(n.features[0])).layer=this.layer,o.sourceLayer=this.layer,_.isSome(o.geometry)&&(o.geometry.spatialReference=this.view.spatialReference),[2,o]):[2,null]}})})},i([w.property()],t.prototype,"_pipelineIsUpdating",void 0),i([w.property()],t.prototype,"_updatingPipelineConfig",void 0),i([w.property()],t.prototype,"_outstandingIdRequests",void 0),i([w.property({dependsOn:["suspended","layer.labelingInfo","layer.labelsVisible"]})],t.prototype,"labelsVisible",null),i([w.property({type:H})],t.prototype,"filter",void 0),i([w.property({type:T})],t.prototype,"effect",null),i([w.property({readOnly:!0,dependsOn:["effect"]})],t.prototype,"effects",null),i([w.property()],t.prototype,"numFeatures",null),i([w.property({dependsOn:["layer.renderer","availableFields","layer.definitionExpression","layer.filter?","layer.historicMoment?","layer.labelingInfo","filter","effect","timeExtent"]})],t.prototype,"renderingConfigHash",null),i([w.property()],t.prototype,"tileRenderer",void 0),i([w.property({dependsOn:["layer.renderer","tileRenderer.updating","_updatingPipelineConfig","_pipelineIsUpdating","_outstandingIdRequests"]})],t.prototype,"updating",void 0),i([w.subclass("esri.views.2d.layers.FeatureLayerView2D")],t)}(w.declared(F,j))}.apply(null,i))||(e.exports=n)},2178:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(29),r(2),r(2174)],void 0===(n=function(e,t,r,i,n,o,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t.lastUpdateId=-1,t.moving=!1,t.updateRequested=!1,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.when(function(){e.requestUpdate()});var t=function(){return e.notifyChange("rendering")};this.handles.add([n.init(this,"suspended",function(t){e.container&&(e.container.visible=!t),e.view&&!t&&e.updateRequested&&e.view.requestLayerViewUpdate(e)},!0),n.init(this,"fullOpacity",function(t){e.container&&(e.container.opacity=t)},!0),n.on(this,"container","post-render",t),n.on(this,"container","will-render",t)])},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,r=this.layer,i=r.minScale,n=r.maxScale;if(null!=i&&null!=n){var o=!i,s=!n;!o&&e<=i&&(o=!0),!s&&e>=n&&(s=!0),t=o&&s}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){var e=this.inherited(arguments);return e&&(e=this.isVisibleAtScale(this.view.scale)),e},i([o.property()],t.prototype,"attached",void 0),i([o.property()],t.prototype,"container",void 0),i([o.property()],t.prototype,"moving",void 0),i([o.property({dependsOn:["attached","suspended","moving"]})],t.prototype,"rendering",null),i([o.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),i([o.property({readOnly:!0})],t.prototype,"updateParameters",void 0),i([o.property()],t.prototype,"updateRequested",void 0),i([o.property({dependsOn:["updateRequested","attached"]})],t.prototype,"updating",null),i([o.property()],t.prototype,"view",void 0),i([o.subclass("esri.views.2d.layers.LayerView2D")],t)}(o.declared(s))}.apply(null,i))||(e.exports=n)},2187:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t){return t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):t&&t.yoffset?Math.max(e,Math.abs(t.yoffset)):e}function i(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){for(var t=0,r=0,i=0;i<e.length;i++){var n=e[i].size;"number"==typeof n&&(t+=n,r++)}return t/r}(e.stops):t}function n(e,t){if(!t)return e;for(var r=t.filter(function(e){return"size"===e.type}).map(function(t){var r=t.maxSize,n=t.minSize;return(i(r,e)+i(n,e))/2}),n=0,o=r.length,s=0;s<o;s++)n+=r[s];var a=Math.floor(n/o);return Math.max(a,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateTolerance=function(e){if(!e)return 6;var t="visualVariables"in e?n(6,e.visualVariables):6;if("simple"===e.type)return r(t,e.symbol);if("unique-value"===e.type){var i=t;return e.uniqueValueInfos.forEach(function(e){i=r(i,e.symbol)}),i}if("class-breaks"===e.type){var o=t;return e.classBreakInfos.forEach(function(e){o=r(o,e.symbol)}),o}return e.type,t}}.apply(null,i))||(e.exports=n)},2216:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(0),r(30)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createQueryGeometry=function(e,t,r){var i=r.get("state.resolution"),o=t*("number"==typeof i?i:1),s=e.clone().offset(-o,-o),a=e.clone().offset(o,o),u=r.spatialReference;return new n({xmin:Math.min(s.x,a.x),ymin:Math.min(s.y,a.y),xmax:Math.max(s.x,a.x),ymax:Math.max(s.y,a.y),spatialReference:u})}}.apply(null,i))||(e.exports=n)},2324:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(13),r(20),r(2118)],void 0===(n=function(e,t,r,i,n){function o(e){return e.stops=function(e,t){return t.length<=u?t:(l.warn("Found "+t.length+" Visual Variable stops, but MapView only supports "+u+". Displayed stops will be simplified."),t.length>2*u?function(e,t){for(var r=t[0],n=t.slice(1),o=n.pop(),u=n[0].value,l=n[n.length-1].value,c=(l-u)/a,p=[],h=u;h<l;h+=c){for(var d=0;h>=n[d].value;)d++;var f=n[d],y=t[d-1],v=h-y.value,g=f.value===y.value?1:v/(f.value-y.value);if("color"===e){var _=n[d],b=t[d-1],m=_.color.clone();m.r=s(b.color.r,m.r,g),m.g=s(b.color.g,m.g,g),m.b=s(b.color.b,m.b,g),m.a=s(b.color.a,m.a,g),p.push({value:h,color:m,label:_.label})}else if("size"===e){var R=n[d],w=t[d-1],S=i.toPt(R.size),x=i.toPt(w.size),O=s(x,S,g);p.push({value:h,size:O,label:R.label})}else{var q=n[d],F=t[d-1],I=s(F.opacity,q.opacity,g);p.push({value:h,opacity:I,label:q.label})}}return[r].concat(p,[o])}(e,t):function(e){for(var t=e[0],r=e.slice(1),i=r.pop();r.length>a;){for(var n=0,o=0,s=1;s<r.length;s++){var u=r[s-1],l=r[s],c=Math.abs(l.value-u.value);c>o&&(o=c,n=s)}r.splice(n,1)}return[t].concat(r,[i])}(t))}(e.type,e.stops),e}function s(e,t,r){return(1-r)*e+r*t}Object.defineProperty(t,"__esModule",{value:!0});var a=n.definitions.WEBGL_MAX_INNER_STOPS,u=n.definitions.WEBGL_MAX_STOPS,l=r.getLogger("esri.renderers.visualVariables.support.utils");t.simplifyVVRenderer=function(e){if(!("visualVariables"in e&&e.visualVariables&&e.visualVariables.length))return e;var t=e.clone(),r=t.visualVariables.map(function(e){return function(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}(e)?o(e):e});return t.visualVariables=r,t}}.apply(null,i))||(e.exports=n)},2472:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(362),r(7)],void 0===(n=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createOrReuseTileRenderer=function(e,t,o){if(!t)return n.resolve(null);switch(t.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":return n.create(function(e){i(function(){return r.e(66).then(function(){var t=[r(2660)];e.apply(null,t)}.bind(this)).catch(r.oe)})}).then(function(e){return e.default}).then(function(e){return new e(o)});case"heatmap":return n.create(function(e){i(function(){return r.e(67).then(function(){var t=[r(2662)];e.apply(null,t)}.bind(this)).catch(r.oe)})}).then(function(e){return e.default}).then(function(e){return new e(o)})}return n.resolve(null)}}.apply(null,i))||(e.exports=n)},2473:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(4),r(9),r(11),r(8),r(283),r(7),r(182),r(164),r(2),r.dj.m(e)],void 0===(n=function(e,t,r,i,n,o,s,a,u,l,c,p,h,d){Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){function n(e){return t.call(this,e)||this}return r(n,t),n.prototype.initialize=function(){this._controller=l.createAbortController(),this.addResolvingPromise(this._startWorker(this._controller.signal))},n.prototype.destroy=function(){this._connection.close(),this._controller.abort()},Object.defineProperty(n.prototype,"tileRenderer",{set:function(e){this.client.tileRenderer=e},enumerable:!0,configurable:!0}),n.prototype.startup=function(e,t,r){var i=this._controller.signal,n=function(e){return Array.isArray(e)}(r.source)?{transferList:r.source,signal:i}:void 0,o={service:r,config:t,tileInfo:e.tileInfo.toJSON()};return this._connection.invoke("startup",o,n)},n.prototype.update=function(e,t){var r={config:e,options:t};return this._connection.invoke("update",r)},n.prototype.refresh=function(){return this._connection.invoke("controller.refresh")},n.prototype.redraw=function(){return this._connection.invoke("controller.redraw")},n.prototype.setViewState=function(e){return this._connection.invoke("setViewState",e.toJSON())},n.prototype.queryFeatures=function(e,t){return this._connection.invoke("controller.queryFeatures",e.toJSON(),t)},n.prototype.queryObjectIds=function(e,t){return this._connection.invoke("controller.queryObjectIds",e.toJSON(),t)},n.prototype.queryFeatureCount=function(e,t){return this._connection.invoke("controller.queryFeatureCount",e.toJSON(),t)},n.prototype.queryExtent=function(e,t){return this._connection.invoke("controller.queryExtent",e.toJSON(),t)},n.prototype.queryLatestObservations=function(e,t){return this._connection.invoke("controller.queryLatestObservations",e.toJSON(),t)},n.prototype.getObjectId=function(e){return this._connection.invoke("controller.getObjectId",e)},n.prototype.getLocalId=function(e){return this._connection.invoke("controller.getLocalId",e)},n.prototype.mapValidLocalIds=function(e){return this._connection.invoke("controller.mapValidLocalIds",e)},n.prototype.onEdits=function(e){var t=e.addedFeatures,r=e.deletedFeatures,i=e.updatedFeatures;return this._connection.invoke("controller.onEdits",{addedFeatures:t,deletedFeatures:r,updatedFeatures:i})},n.prototype.enableEvent=function(e,t){return this._connection.invoke("controller.enableEvent",{name:e,value:t})},n.prototype._startWorker=function(t){return s(this,void 0,void 0,function(){var r,i;return o(this,function(n){switch(n.label){case 0:return r=c.getAbsMid("../features/Pipeline",e,d),[4,p.open(r,{client:this.client,strategy:"dedicated",signal:t})];case 1:return i=n.sent(),this._connection=i,[2]}})})},i([h.property()],n.prototype,"client",void 0),i([h.property()],n.prototype,"tileRenderer",null),i([h.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],n)}(h.declared(a,u));t.default=f}.apply(null,i))||(e.exports=n)},2474:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(16)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=new r.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});t.toJSONGeometryType=function(e){return i.toJSON(e)}}.apply(null,i))||(e.exports=n)}}]);