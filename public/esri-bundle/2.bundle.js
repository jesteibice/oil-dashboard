(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/layers/i3s/I3SUtil":2182,"esri/views/3d/layers/i3s/I3SBinaryReader":2184,"esri/views/3d/support/orientedBoundingBox":2195,"esri/core/libs/gl-matrix-2/quatf32":2201,"esri/views/3d/layers/i3s/LEPCC":2209,"esri/core/libs/gl-matrix-2/factories/quatf32":2246,"esri/views/3d/support/dito":2404})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2182:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(23),r(58),r(15),r(14),r(7),r(152),r(24),r(43),r(32),r(55),r(57),r(478),r(163),r(2184),r(38),r(79)],void 0===(a=function(e,t,r,n,a,o,i,u,s,c,f,l,d,h,v,y,p,b){function m(e){return e&&parseInt(e.substring(e.lastIndexOf("/")+1,e.length),10)}function g(e,t){var r=t[0],n=t[1],a=t[2],o=t[3],i=e[0]-r,u=r-e[3],s=e[1]-n,c=n-e[4],f=e[2]-a,l=a-e[5],d=Math.max(i,u,0),h=Math.max(s,c,0),v=Math.max(f,l,0),y=d*d+h*h+v*v;return y>o*o?0:y>0?1:-Math.max(i,u,s,c,f,l)>o?3:2}function w(e,t,r){for(var n=[],a=r&&r.missingFields,o=r&&r.originalFields,i=0,u=e;i<u.length;i++){for(var s=u[i],c=s.toLowerCase(),f=!1,l=0,d=t;l<d.length;l++){var h=d[l];if(c===h.name.toLowerCase()){n.push(h.name),f=!0,o&&o.push(s);break}}!f&&a&&a.push(s)}return n}function M(e,t,r){if(null!=e.maxRecordCount&&t.length>e.maxRecordCount){var n=function(e,t){for(var r=e.length,n=Math.ceil(r/t),a=[],o=0;o<n;o++){var i=Math.floor(r*o/n),u=Math.floor(r*(o+1)/n);a.push(e.slice(i,u))}return a}(t,e.maxRecordCount);return i.all(n.map(function(t){return M(e,t,r)})).then(C)}var o=new v({objectIds:t,outFields:r,orderByFields:[e.objectIdField]});return new h(e.parsedUrl.path).execute(o).then(function(e){return e&&e.features&&e.features.length===t.length?e.features.map(function(e){return e.attributes}):i.reject(new a("scenelayer:feature-not-in-associated-layer","Feature not found in associated feature layer"))})}function x(e,t,n,o,u,s){for(var c=[],f=0,l=t;f<l.length;f++){var d=l[f];if(d&&-1!==u.indexOf(d.name)){var h=e+"/nodes/"+n.resources.attributes+"/attributes/"+d.key+"/0";c.push({url:h,storageInfo:d})}}return i.eachAlways(c.map(function(e){return r(e.url,{responseType:"array-buffer"}).then(function(t){return y.readBinaryAttribute(e.storageInfo,t.data)})})).then(function(e){var t=[];if(!s.ignoreUnavailableFields&&e.some(function(e){return null==e.value})){for(var r=[],n=0;n<e.length;n++)null==e[n].value&&r.push({name:c[n].storageInfo.name,error:e[n].error});return i.reject(new a("scenelayer:attribute-request-failed","Request for scene layer attributes failed",{failedAttributes:r}))}for(var u=0,f=o;u<f.length;u++){var l=f[u],d={};for(n=0;n<e.length;n++)null!=e[n].value&&(d[c[n].storageInfo.name]=I(e[n].value,l));t.push(d)}return t})}function I(e,t){if(!e)return null;var r=e[t];return u.isInt16Array(e)?r===F?null:r:u.isInt32Array(e)?r===O?null:r:r!=r?null:r}function C(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r];t=t.concat(a)}return t}function A(e){var t=new f(m(e.store.indexCRS||e.store.geographicCRS));return t.equals(e.spatialReference)?e.spatialReference:t}function S(e){var t=new f(m(e.store.vertexCRS||e.store.projectedCRS));return t.equals(e.spatialReference)?e.spatialReference:t}function P(e,t,r){if(!d.canProject(e,t))throw new a("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});if("local"===r&&e.isGeographic)throw new a("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",{})}function j(e,t,r){var n=A(e),a=S(e);P(n,t,r),P(a,t,r)}function T(e){return"mesh-3d"===e.type}Object.defineProperty(t,"__esModule",{value:!0}),t.DDS_ENCODING_STRING="image/vnd-ms.dds",t.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"],t.extractWkid=m,t.selectEncoding=function(e,r){if(r)for(var n=0;n<e.length;n++)if(e[n].encoding===t.DDS_ENCODING_STRING)return e[n];for(n=0;n<e.length;n++)if(t.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(e[n].encoding)>-1)return e[n];return null},t.findIntersectingNodes=function(e,t,r,n,a,o){a.traverse(r,function(r){var a=r.mbs;t!==n&&(a=z,p.mbsToMbs(r.mbs,n,a,t));var i=g(e,a);if(0!==i)return o(r,i),!0})},t.filterInPlace=function(e,t,r){for(var n=0,a=0,o=0;o<t.length&&n<e.length;o++)e[n]===t[o]&&(r(o)&&(e[a]=e[n],a++),n++);e.length=a};var U=l.create();t.getClipAABB=function(e,t){var r=s.mat4.copy(b.sm4d.get(),t.objectTransformation),n=t.getGeometryRecords()[0].getShaderTransformation();if(s.mat4.multiply(r,r,n),0===r[1]&&0===r[2]&&0===r[3]&&0===r[4]&&0===r[6]&&0===r[7]&&0===r[8]&&0===r[9]&&0===r[11]&&1===r[15])return U[0]=(e[0]-r[12])/r[0],U[1]=(e[1]-r[13])/r[5],U[2]=(e[2]-r[14])/r[10],U[3]=(e[3]-r[12])/r[0],U[4]=(e[4]-r[13])/r[5],U[5]=(e[5]-r[14])/r[10],U};var z=c.vec4f64.create();t.intersectBoundingBoxWithMbs=g,t.findFieldsCaseInsensitive=w,t.whenGraphicAttributes=function(e,t,r,o,u,s){var c=!0===(s&&s.populateObjectId),f=s.ignoreUnavailableFields?void 0:[],l=1===o.length&&"*"===o[0];!l&&c&&(o=function(e,t){return e.filter(function(e){return e.toLowerCase()!==t.toLowerCase()}).concat([t])}(o,r));var d=l?o:w(o,e.fields,{missingFields:f});if(f&&0!==f.length)return i.reject(new a("scenelayer:unknown-fields","This scene layer does not have the requested fields",{unknownFields:f}));if(0===t.length)return i.resolve(t);var h=e.associatedLayer,v=e.attributeStorageInfo,y=l?e.fields.map(function(e){return e.name}):d;if(h)return function(e,t,r,n){t.sort(function(e,t){return e.attributes[r]-t.attributes[r]});var a=t.map(function(e){return e.attributes[r]}),o=[],i=w(n,e.fields,{originalFields:o});return M(e,a,i).then(function(e){for(var r=0;r<t.length;r++){var n=t[r],a=e[r];n.attributes={};for(var u=0;u<o.length;u++)n.attributes[o[u]]=a[i[u]]}return t})}(h,t,r,y);var p=function(e,t){for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n];o in t.attributes||r.push(o)}return r}(y,t[0]);if(0===p.length)return i.resolve(t);if(v){var b=u(t);if(!b)return i.reject(new a("scenelayer:features-not-loaded","Tried to query attributes for unloaded features"));var m=e.parsedUrl.path;return i.all(b.map(function(e){return x(m,v,e.node,e.indices,p,s).then(function(t){for(var r=0;r<e.graphics.length;r++){for(var n=0,a=y;n<a.length;n++){var o=a[n];o in t[r]||(t[r][o]=e.graphics[r].attributes[o])}e.graphics[r].attributes=t[r]}return e.graphics})})).then(n.flatten)}return i.reject(new a("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available"))};var F=-Math.pow(2,15),O=-Math.pow(2,31);t.getCachedAttributeValue=I,t.convertFlatRangesToOffsets=function(e,t,r){for(var n=null!=t?t:e.length/r,o=new Uint32Array(n+1),i=0;i<n;i++){var u=e[i*r],s=3*u;o[i]=s;var c=(i-1)*r+1;if(c>=0&&u-1!==e[c])throw new a("Face ranges are not continuous")}var f=3*(e[(n-1)*r+1]+1);return o[o.length-1]=f,o},t.getIndexCrs=A,t.getVertexCrs=S,t.getCacheKeySuffix=function(e,t){return t===p.SphericalECEFSpatialReference?"@ECEF":e.equals(t)?"":null!=t.wkid?"@"+t.wkid:null},t.checkSpatialReference=P,t.checkSpatialReferences=j,t.checkSceneLayerValid=function(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function(e){return!(null!=e.geometryType&&"triangles"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new a("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",{})},t.checkSceneLayerCompatibleWithView=function(e,t){j(e,t.spatialReference,t.viewingMode)},t.checkPointCloudLayerValid=function(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function(e){return!(null==e.geometryType||"points"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null!=e.encoding&&""!==e.encoding&&"lepcc-xyz"!==e.encoding||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new a("pointcloud:unsupported-geometry-schema","The geometry schema of this point cloud scene layer is not supported.",{})},t.checkPointCloudLayerCompatibleWithView=function(e,t){P(e.spatialReference,t.spatialReference,t.viewingMode)},t.rendererNeedsTextures=function(e){if(null==e||!function(e){return"simple"===e.type||"class-breaks"===e.type||"unique-value"===e.type}(e))return!0;if(("unique-value"===e.type||"class-breaks"===e.type)&&null==e.defaultSymbol)return!0;var t=e.getSymbols();if(0===t.length)return!0;for(var r=0,n=t;r<n.length;r++){var a=n[r];if(!T(a)||0===a.symbolLayers.length)return!0;for(var i=0,u=a.symbolLayers.items;i<u.length;i++){var s=u[i];if("fill"!==s.type||o.isNone(s.material)||o.isNone(s.material.color)||"replace"!==s.material.colorMixMode)return!0}}return!1};var B=function(){return function(){this.edges=null,this.material=null,this.castShadows=!0}}();t.SymbolInfo=B,t.getSymbolInfo=function(e){for(var t=new B,r=!1,n=!1,a=0,i=e.symbolLayers.items;a<i.length;a++){var u=i[a];if("fill"===u.type&&u.enabled){var s=u.material,c=u.edges;if(o.isSome(s)&&!r){var f=s.color,l=s.colorMixMode;o.isSome(f)?t.material={color:[f.r/255,f.g/255,f.b/255],alpha:f.a,colorMixMode:l}:t.material={color:[1,1,1],alpha:1,colorMixMode:"multiply"},t.castShadows=u.castShadows,r=!0}o.isSome(c)&&!n&&(t.edges=c,n=!0)}}return t.material||(t.material={color:[1,1,1],alpha:1,colorMixMode:"multiply"}),t},t.addWraparound=function(e,t){return(0|e)+(0|t)|0}}.apply(null,n))||(e.exports=a)},2184:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(15),r(5),r(13),r(2209)],void 0===(a=function(e,t,r,n,a,o){function i(e,t,n){for(var a="",o=0;o<n;){var i=e[t+o];if(i<128)a+=String.fromCharCode(i),o++;else if(i>=192&&i<224){if(o+1>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var u=(31&i)<<6|63&e[t+o+1];a+=String.fromCharCode(u),o+=2}else if(i>=224&&i<240){if(o+2>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");u=(15&i)<<12|(63&e[t+o+1])<<6|63&e[t+o+2];a+=String.fromCharCode(u),o+=3}else{if(!(i>=240&&i<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(o+3>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((u=(7&i)<<18|(63&e[t+o+1])<<12|(63&e[t+o+2])<<6|63&e[t+o+3])>=65536){var s=55296+(u-65536>>10),c=56320+(1023&u);a+=String.fromCharCode(s,c)}else a+=String.fromCharCode(u);o+=4}}return a}function u(e,r){for(var n={byteOffset:0,byteCount:0,fields:Object.create(null)},a=0,o=0;o<r.length;o++){var i=r[o],u=i.valueType||i.type,s=t.valueType2ArrayBufferReader[u];n.fields[i.property]=s(e,a),a+=t.valueType2TypedArrayClassMap[u].BYTES_PER_ELEMENT}return n.byteCount=a,n}function s(e,t,n){var a,o,u=[],s=0;for(o=0;o<e;o+=1){if((a=t[o])>0){if(u.push(i(n,s,a-1)),0!==n[s+a-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else u.push(null);s+=a}return u}function c(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function f(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function l(e,t,a){for(var o=null!=t.header?u(e,t.header):{byteOffset:0,byteCount:0,fields:{count:a}},i={header:o,byteOffset:o.byteCount,byteCount:0,entries:Object.create(null)},s=o.byteCount,c=0;c<t.ordering.length;c++){var f=t.ordering[c],l=n.clone(t[f]);if(l.count=o.fields.count,"String"===l.valueType){if(l.byteOffset=s,l.byteCount=o.fields[f+"ByteCount"],"UTF-8"!==l.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:l.encoding})}else{if(!h(l.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:l.valueType});var d=v(l.valueType);s+=s%d!=0?d-s%d:0,l.byteOffset=s,l.byteCount=d*l.valuesPerElement*l.count}s+=l.byteCount,i.entries[f]=l}return i.byteCount=s-i.byteOffset,i}function d(e,t,n){if(t!==e&&y.error("Invalid "+n+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function h(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function v(e){return h(e)?t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT:0}Object.defineProperty(t,"__esModule",{value:!0});var y=a.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=u,t.readStringArray=s,t.createTypedView=c,t.createRawView=f,t.createAttributeDataIndex=l,t.createGeometryIndexFromDefinition=function(e,t,r){for(var n={header:{byteOffset:0,byteCount:e.offset,fields:{}},byteOffset:e.offset,byteCount:0,vertexAttributes:{},featureAttributes:{}},a=e.offset,o=function(e,t,r,n){var o="UInt64"===t.type?8:v(t.type),i={byteOffset:a,byteCount:o*t.component*r,count:r,valueType:t.type,valuesPerElement:t.component};a+=i.byteCount,n[e]=i},i=0,u=p;i<u.length;i++){var s=u[i];e[s[0]]&&o(s[1],e[s[0]],t,n.vertexAttributes)}for(var c=0,f=b;c<f.length;c++){var l=f[c];e[l[0]]&&o(l[1],e[l[0]],r,n.featureAttributes)}return n};var p=[["position","position"],["normal","normal"],["uv0","uv0"],["uv1","uv1"],["color","color"],["uvRegion","region"]],b=[["featureId","id"],["faceRange","faceRange"]];t.createGeometryIndexFromSchema=function(e,t){for(var r=u(e,t&&t.header),a=r.byteCount,o={header:r,byteOffset:r.byteCount,byteCount:0,vertexAttributes:n.clone(t.vertexAttributes)},i=o.vertexAttributes,s=r.fields,c=null!=s.vertexCount?s.vertexCount:s.count,f=0;f<t.ordering.length;f++){var l=t.ordering[f];null!=i[l]&&(i[l].byteOffset=a,i[l].count=c,a+=v(i[l].valueType)*i[l].valuesPerElement*c)}var h=s.faceCount;if(t.faces&&h){o.faces=n.clone(t.faces);var y=o.faces;for(f=0;f<t.ordering.length;f++){var p=t.ordering[f];null!=y[p]&&(y[p].byteOffset=a,y[p].count=h,a+=v(y[p].valueType)*y[p].valuesPerElement*h)}}var b=s.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&b){o.featureAttributes=n.clone(t.featureAttributes);var m=o.featureAttributes;for(f=0;f<t.featureAttributeOrder.length;f++){var g=t.featureAttributeOrder[f];m[g].byteOffset=a,m[g].count=b;var w=v(m[g].valueType);"UInt64"===m[g].valueType&&(w=8),a+=w*m[g].valuesPerElement*b}}return d(a,e.byteLength,"geometry"),o.byteCount=a-o.byteOffset,o},t.readBinaryAttribute=function(e,t,n){if("lepcc-rgb"===e.encoding)return o.decodeRGB(t);if("lepcc-intensity"===e.encoding)return o.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(y.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(y.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var a=l(t,e,n);d(a.byteOffset+a.byteCount,t.byteLength,"attribute");var i=a.entries.attributeValues||a.entries.objectIds;if(i){if("String"===i.valueType){var u=a.entries.attributeByteCounts,h=c(t,u),v=f(t,i);return s(u.count,h,v)}return c(t,i)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=h,t.getBytesPerValue=v}.apply(null,n))||(e.exports=a)},2195:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(94),r(78),r(476),r(2201),r(374),r(10),r(354),r(6),r(70),r(43),r(55),r(2404),r(41)],void 0===(a=function(e,t,r,n,a,o,i,u,s,c,f,l,d,h,v){function y(e,t,r){return{center:c.vec3f64.clone(e),halfSize:s.vec3f32.clone(t),quaternion:o.quatf32.clone(r)}}function p(e,t){var r=v.plane.signedDistance(t,e.center),n=b(e,t);return r>n?1:r<-n?-1:0}function b(e,t){a.quat.conjugate(m,e.quaternion),u.vec3.transformQuat(g,t,m);var r=e.halfSize;return Math.abs(g[0]*r[0])+Math.abs(g[1]*r[1])+Math.abs(g[2]*r[2])}Object.defineProperty(t,"__esModule",{value:!0});var m=i.quatf64.create(),g=c.vec3f64.create(),w=c.vec3f64.create(),M=l.vec4f64.create(),x=n.mat3f64.create(),I=function(){return function(e){var t=56*e;this.buffer=new ArrayBuffer(t),this.obbs=new Array(e);for(var r=0;r<e;r++)this.obbs[r]={center:c.vec3f64.createView(this.buffer,56*r+0),halfSize:s.vec3f32.createView(this.buffer,56*r+24),quaternion:o.quatf32.createView(this.buffer,56*r+36)}}}();t.ObbArray=I,t.create=y,t.clone=function(e){return y(e.center,e.halfSize,e.quaternion)},t.set=function(e,t){u.vec3.copy(t.center,e.center),u.vec3.copy(t.halfSize,e.halfSize),a.quat.copy(t.quaternion,e.quaternion)},t.compute=function(e,t){return t||(t=y([0,0,0],[-1,-1,-1],[0,0,0,1])),h.computeOBB(e,t),t},t.intersectPlane=p,t.toAaBoundingBox=function(e,t){t||(t=d.create());var n=r.mat3.fromQuat(x,e.quaternion),a=e.halfSize[0]*Math.abs(n[0])+e.halfSize[1]*Math.abs(n[3])+e.halfSize[2]*Math.abs(n[6]),o=e.halfSize[0]*Math.abs(n[1])+e.halfSize[1]*Math.abs(n[4])+e.halfSize[2]*Math.abs(n[7]),i=e.halfSize[0]*Math.abs(n[2])+e.halfSize[1]*Math.abs(n[5])+e.halfSize[2]*Math.abs(n[8]);return t[0]=e.center[0]-a,t[1]=e.center[1]-o,t[2]=e.center[2]-i,t[3]=e.center[0]+a,t[4]=e.center[1]+o,t[5]=e.center[2]+i,t},t.minimumDistancePlane=function(e,t){return v.plane.signedDistance(t,e.center)-b(e,t)},t.maximumDistancePlane=function(e,t){return v.plane.signedDistance(t,e.center)+b(e,t)},t.isVisible=function(e,t){return p(e,t.planes[0])<=0&&p(e,t.planes[1])<=0&&p(e,t.planes[2])<=0&&p(e,t.planes[3])<=0&&p(e,t.planes[4])<=0&&p(e,t.planes[5])<=0},t.intersectLine=function(e,t,r,n){void 0===n&&(n=0),a.quat.conjugate(m,e.quaternion),u.vec3.subtract(g,t,e.center);for(var o=u.vec3.transformQuat(g,g,m),i=u.vec3.transformQuat(w,r,m),s=-1/0,c=1/0,f=0;f<3;f++)if(Math.abs(i[f])>1e-6){var l=(n+e.halfSize[f]-o[f])/i[f],d=(-n-e.halfSize[f]-o[f])/i[f];s=Math.max(s,Math.min(l,d)),c=Math.min(c,Math.max(l,d))}else if(o[f]>e.halfSize[f]+n||o[f]<-e.halfSize[f]-n)return!1;return s<=c},t.projectedArea=function(e,t,n,o,i){a.quat.conjugate(m,e.quaternion),u.vec3.sub(g,t,e.center),u.vec3.transformQuat(g,g,m);var s=g[0]<-e.halfSize[0]?-1:g[0]>e.halfSize[0]?1:0,c=g[1]<-e.halfSize[1]?-1:g[1]>e.halfSize[1]?1:0,l=g[2]<-e.halfSize[2]?-1:g[2]>e.halfSize[2]?1:0,d=Math.abs(s)+Math.abs(c)+Math.abs(l);if(0===d)return 1/0;var h=1===d?4:6,v=6*(s+3*c+9*l+13);r.mat3.fromQuat(x,e.quaternion),r.mat3.scale(x,x,e.halfSize);for(var y=0;y<h;y++){var p=A[v+y];u.vec3.set(g,((1&p)<<1)-1,(2&p)-1,((4&p)>>1)-1),u.vec3.transformMat3(g,g,x),u.vec3.add(M,e.center,g),M[3]=1,f.vec4.transformMat4(M,M,n);var b=1/Math.max(1e-6,M[3]);C[2*y]=M[0]*b,C[2*y+1]=M[1]*b}var w=2*h-2,I=C[0]*(C[3]-C[w+1])+C[w]*(C[1]-C[w-1]);for(y=2;y<w;y+=2)I+=C[y]*(C[y+3]-C[y-1]);return Math.abs(I)*o*i*.125};var C=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],A=function(){var e=new Int8Array(162),t=0,r=function(r){for(var n=0;n<r.length;n++)e[t+n]=r[n];t+=6};return r([6,2,3,1,5,4]),r([0,2,3,1,5,4]),r([0,2,3,7,5,4]),r([0,1,3,2,6,4]),r([0,1,3,2,0,0]),r([0,1,5,7,3,2]),r([0,1,3,7,6,4]),r([0,1,3,7,6,2]),r([0,1,5,7,6,2]),r([0,1,5,4,6,2]),r([0,1,5,4,0,0]),r([0,1,3,7,5,4]),r([0,2,6,4,0,0]),r([0,0,0,0,0,0]),r([1,3,7,5,0,0]),r([2,3,7,6,4,0]),r([2,3,7,6,0,0]),r([2,3,1,5,7,6]),r([0,1,5,7,6,2]),r([0,1,5,7,6,4]),r([0,1,3,7,6,4]),r([4,5,7,6,2,0]),r([4,5,7,6,0,0]),r([4,5,1,3,7,6]),r([0,2,3,7,5,4]),r([6,2,3,7,5,4]),r([6,2,3,1,5,4]),e}()}.apply(null,n))||(e.exports=a)},2201:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(2246)],void 0===(a=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.quatf32=r}.apply(null,n))||(e.exports=a)},2209:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(15)],void 0===(a=function(e,t,r){function n(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+f.identifierOffset,f.identifierLength)),version:t.getUint16(r+f.versionOffset,c),checksum:t.getUint32(r+f.checksumOffset,c)}}function a(e,t){return{sizeLo:e.getUint32(t+l.sizeLo,c),sizeHi:e.getUint32(t+l.sizeHi,c),minX:e.getFloat64(t+l.minX,c),minY:e.getFloat64(t+l.minY,c),minZ:e.getFloat64(t+l.minZ,c),maxX:e.getFloat64(t+l.maxX,c),maxY:e.getFloat64(t+l.maxY,c),maxZ:e.getFloat64(t+l.maxZ,c),errorX:e.getFloat64(t+l.errorX,c),errorY:e.getFloat64(t+l.errorY,c),errorZ:e.getFloat64(t+l.errorZ,c),count:e.getUint32(t+l.count,c),reserved:e.getUint32(t+l.reserved,c)}}function o(e,t,r){var n=[];t=i(e,t,n);for(var a=[],o=0;o<n.length;o++){a.length=0,t=i(e,t,a);for(var u=0;u<a.length;u++)r.push(a[u]+n[o])}return t}function i(e,t,n){var a=new DataView(e,t),o=a.getUint8(0),i=31&o,u=!!(32&o),s=(192&o)>>6,f=0;if(0===s)f=a.getUint32(1,c),t+=5;else if(1===s)f=a.getUint16(1,c),t+=3;else{if(2!==s)throw new r("lepcc-decode-error","Bad count type");f=a.getUint8(1),t+=2}if(u)throw new r("lepcc-decode-error","LUT not implemented");for(var l=Math.ceil(f*i/8),d=new Uint8Array(e,t,l),h=0,v=0,y=0,p=-1>>>32-i,b=0;b<f;b++){for(;v<i;)h|=d[y]<<v,v+=8,y+=1;n[b]=h&p,h>>>=i,(v-=i)+i>32&&(h|=d[y-1]>>8-v)}return t+y}function u(e,t){return{sizeLo:e.getUint32(t+d.sizeLo,c),sizeHi:e.getUint32(t+d.sizeHi,c),count:e.getUint32(t+d.count,c),colorMapCount:e.getUint16(t+d.colorMapCount,c),lookupMethod:e.getUint8(t+d.lookupMethod),compressionMethod:e.getUint8(t+d.compressionMethod)}}function s(e,t){return{sizeLo:e.getUint32(t+h.sizeLo,c),sizeHi:e.getUint32(t+h.sizeHi,c),count:e.getUint32(t+h.count,c),scaleFactor:e.getUint16(t+h.scaleFactor,c),bitsPerPoint:e.getUint8(t+h.bitsPerPoint),reserved:e.getUint8(t+h.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var c=!0,f={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},l={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),i=0,u=n(e,t,i),s=u.identifier,c=u.version;if(i+=f.byteCount,"LEPCC     "!==s)throw new r("lepcc-decode-error","Bad identifier");if(c>1)throw new r("lepcc-decode-error","Unknown version");var d=a(t,i);if(i+=l.byteCount,d.sizeHi*Math.pow(2,32)+d.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var h=new Float64Array(3*d.count),v=[],y=[],p=[],b=[];if((i=o(e,i=o(e,i=o(e,i=o(e,i,v),y),p),b))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var m=0,g=0,w=0;w<v.length;w++){g+=v[w];for(var M=0,x=0;x<y[w];x++){M+=p[m];var I=b[m];h[3*m]=Math.min(d.maxX,d.minX+2*d.errorX*M),h[3*m+1]=Math.min(d.maxY,d.minY+2*d.errorY*g),h[3*m+2]=Math.min(d.maxZ,d.minZ+2*d.errorZ*I),m++}}return{errorX:d.errorX,errorY:d.errorY,errorZ:d.errorZ,result:h}};var d={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),a=0,o=n(e,t,a),i=o.identifier,s=o.version;if(a+=f.byteCount,"ClusterRGB"!==i)throw new r("lepcc-decode-error","Bad identifier");if(s>1)throw new r("lepcc-decode-error","Unknown version");var c=u(t,a);if(a+=d.byteCount,c.sizeHi*Math.pow(2,32)+c.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if((2===c.lookupMethod||1===c.lookupMethod)&&0===c.compressionMethod){if(3*c.colorMapCount+c.count+a!==e.byteLength||c.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");for(var l=new Uint8Array(e,a,3*c.colorMapCount),h=new Uint8Array(e,a+3*c.colorMapCount,c.count),v=new Uint8Array(3*c.count),y=0;y<c.count;y++){var p=h[y];v[3*y]=l[3*p],v[3*y+1]=l[3*p+1],v[3*y+2]=l[3*p+2]}return v}if(0===c.lookupMethod&&0===c.compressionMethod){if(3*c.count+a!==e.byteLength||0!==c.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,a).slice()}if(c.lookupMethod<=2&&1===c.compressionMethod){if(a+3!==e.byteLength||1!==c.colorMapCount)throw new r("lepcc-decode-error","Bad count");var b=t.getUint8(a),m=t.getUint8(a+1),g=t.getUint8(a+2);for(v=new Uint8Array(3*c.count),y=0;y<c.count;y++)v[3*y]=b,v[3*y+1]=m,v[3*y+2]=g;return v}throw new r("lepcc-decode-error","Bad method "+c.lookupMethod+","+c.compressionMethod)};var h={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),a=0,o=n(e,t,a),u=o.identifier,c=o.version;if(a+=f.byteCount,"Intensity "!==u)throw new r("lepcc-decode-error","Bad identifier");if(c>1)throw new r("lepcc-decode-error","Unknown version");var l=s(t,a);if(a+=h.byteCount,l.sizeHi*Math.pow(2,32)+l.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var d=new Uint16Array(l.count);if(8===l.bitsPerPoint){if(l.count+a!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var v=new Uint8Array(e,a,l.count),y=0;y<l.count;y++)d[y]=v[y]*l.scaleFactor}else if(16===l.bitsPerPoint){if(2*l.count+a!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=new Uint16Array(e,a,l.count),y=0;y<l.count;y++)d[y]=v[y]*l.scaleFactor}else{if(i(e,a,v=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(y=0;y<l.count;y++)d[y]=v[y]*l.scaleFactor}return d}}.apply(null,n))||(e.exports=a)},2246:function(e,t,r){var n,a;n=[r.dj.c(e.i),t],void 0===(a=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){var e=new Float32Array(4);return e[3]=1,e},t.clone=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var a=new Float32Array(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a},t.createView=function(e,t){return new Float32Array(e,t,4)}}.apply(null,n))||(e.exports=a)},2404:function(e,t,r){var n,a;n=[r.dj.c(e.i),t],void 0===(a=function(e,t){function r(e,t,r,n,a,i,u,s,c,f,l){return function(e,t,r){for(var n=g(e.maxVert[0],e.minVert[0]),a=0,o=1;o<7;++o){var i=g(e.maxVert[o],e.minVert[o]);i>n&&(n=i,a=o)}y(t,e.minVert[a]),y(r,e.maxVert[a])}(e,n,a),g(n,a)<M?1:(h(u,n,a),b(u,u),function(e,t,r,n){for(var a=e.data,o=e.offsetIdx,i=e.strideIdx,u=Number.NEGATIVE_INFINITY,s=0,c=o;c<a.length;c+=i){F[0]=a[c]-t[0],F[1]=a[c+1]-t[1],F[2]=a[c+2]-t[2];var f=r[0]*F[0]+r[1]*F[1]+r[2]*F[2],l=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],d=F[0]*F[0]+F[1]*F[1]+F[2]*F[2],h=d-f*f/l;h>u&&(u=h,s=c)}return y(n,a,s),u}(t,n,u,i)<M?2:(h(s,a,i),b(s,s),h(c,i,n),b(c,c),p(r,s,u),b(r,r),o(t,r,u,s,c,f),0))}function n(e,t,r,n,i,u,s,c,f,l){a(e,t,r,n,i,C,A),void 0!==C[0]&&(h(S,C,r),b(S,S),h(P,C,n),b(P,P),h(j,C,i),b(j,j),p(T,P,u),b(T,T),p(U,j,s),b(U,U),p(z,S,c),b(z,z),o(e,T,u,P,S,f),o(e,U,s,j,P,f),o(e,z,c,S,j,f)),void 0!==A[0]&&(h(S,A,r),b(S,S),h(P,A,n),b(P,P),h(j,A,i),b(j,j),p(T,P,u),b(T,T),p(U,j,s),b(U,U),p(z,S,c),b(z,z),o(e,T,u,P,S,f),o(e,U,s,j,P,f),o(e,z,c,S,j,f))}function a(e,t,r,n,a,o,i){!function(e,t,r,n,a){var o=e.data,i=e.offsetIdx,u=e.strideIdx;y(n,o,i),y(a,n),r[0]=w(N,t),r[1]=r[0];for(var s=i+u;s<o.length;s+=u){var c=o[s]*t[0]+o[s+1]*t[1]+o[s+2]*t[2];c<r[0]&&(r[0]=c,y(n,o,s)),c>r[1]&&(r[1]=c,y(a,o,s))}}(e,t,O,i,o);var u=w(r,t);O[1]-M<=u&&(o[0]=void 0),O[0]+M>=u&&(i[0]=void 0)}function o(e,t,r,n,a,o){if(!(m(t)<M)){p(B,r,t),p(V,n,t),p(L,a,t),i(e,t,O),R[1]=O[0],q[1]=O[1],E[1]=q[1]-R[1];for(var u=[r,n,a],s=[B,V,L],c=0;c<3;++c){i(e,u[c],O),R[0]=O[0],q[0]=O[1],i(e,s[c],O),R[2]=O[0],q[2]=O[1],E[0]=q[0]-R[0],E[2]=q[2]-R[2];var f=l(E);f<o.quality&&(y(o.b0,u[c]),y(o.b1,t),y(o.b2,s[c]),o.quality=f)}}}function i(e,t,r){var n=e.data,a=e.offsetIdx,o=e.strideIdx;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var i=a;i<n.length;i+=o){var u=n[i]*t[0]+n[i+1]*t[1]+n[i+2]*t[2];r[0]=Math.min(r[0],u),r[1]=Math.max(r[1],u)}}function u(e,t,r){y(r.center,e),v(r.halfSize,t,.5),r.quaternion[0]=0,r.quaternion[1]=0,r.quaternion[2]=0,r.quaternion[3]=1}function s(e,t,r){y(_,t),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?_[0]=0:Math.abs(t[1])>Math.abs(t[2])?_[1]=0:_[2]=0,m(_)<M&&(_[0]=_[1]=_[2]=1),p(k,t,_),b(k,k),p(D,t,k),b(D,D),c(e,t,k,D,G,Y),h(X,Y,G),f(t,k,D,G,Y,X,r)}function c(e,t,r,n,a,o){i(e,t,O),a[0]=O[0],o[0]=O[1],i(e,r,O),a[1]=O[0],o[1]=O[1],i(e,n,O),a[2]=O[0],o[2]=O[1]}function f(e,t,r,n,a,o,i){H[0]=e[0],H[1]=e[1],H[2]=e[2],H[3]=t[0],H[4]=t[1],H[5]=t[2],H[6]=r[0],H[7]=r[1],H[8]=r[2],function(e,t){var r=t[0]+t[4]+t[8];if(r>0){var n=Math.sqrt(r+1);e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n}else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3,n=Math.sqrt(t[3*a+a]-t[3*o+o]-t[3*i+i]+1);e[a]=.5*n,n=.5/n,e[3]=(t[3*o+i]-t[3*i+o])*n,e[o]=(t[3*o+a]+t[3*a+o])*n,e[i]=(t[3*i+a]+t[3*a+i])*n}}(i.quaternion,H),d(W,n,a),v(W,W,.5),v(i.center,e,W[0]),v(Z,t,W[1]),d(i.center,i.center,Z),v(Z,r,W[2]),d(i.center,i.center,Z),v(i.halfSize,o,.5)}function l(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}function d(e,t,r){e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2]}function h(e,t,r){e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2]}function v(e,t,r){e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r}function y(e,t,r){void 0===r&&(r=0),e[0]=t[r+0],e[1]=t[r+1],e[2]=t[r+2]}function p(e,t,r){var n=t[0],a=t[1],o=t[2],i=r[0],u=r[1],s=r[2];e[0]=a*s-o*u,e[1]=o*i-n*s,e[2]=n*u-a*i}function b(e,t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(r>0){var n=1/Math.sqrt(r);e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}}function m(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function g(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a}function w(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0});var M=1e-6,x=[0,0,0],I=[0,0,0];t.computeOBB=function(e,t){var a=e.data,o=e.strideIdx,i=a.length/o;if(!(i<=0)){var y=new J(e);d(x,y.minProj,y.maxProj),v(x,x,.5),h(I,y.maxProj,y.minProj);var p=l(I),b=new K;b.quality=p,i<14&&(e={data:new Float64Array(y.buffer,112,42),size:3,offsetIdx:0,strideIdx:3});var m=[0,0,0],g=[0,0,0],w=[0,0,0],M=[0,0,0],C=[0,0,0],A=[0,0,0],S=[0,0,0];switch(r(y,e,S,m,g,w,M,C,A,b)){case 1:return void u(x,I,t);case 2:return void s(e,M,t)}n(e,S,m,g,w,M,C,A,b),c(e,b.b0,b.b1,b.b2,G,Y);var P=[0,0,0];h(P,Y,G),b.quality=l(P),b.quality<p?f(b.b0,b.b1,b.b2,G,Y,P,t):u(x,I,t)}};var C=[0,0,0],A=[0,0,0],S=[0,0,0],P=[0,0,0],j=[0,0,0],T=[0,0,0],U=[0,0,0],z=[0,0,0],F=[0,0,0],O=[0,0],B=[0,0,0],V=[0,0,0],L=[0,0,0],q=[0,0,0],R=[0,0,0],E=[0,0,0],N=[0,0,0],_=[0,0,0],k=[0,0,0],D=[0,0,0],G=[0,0,0],Y=[0,0,0],X=[0,0,0],Z=[0,0,0],H=[1,0,0,0,1,0,0,0,1],W=[0,0,0],Q=7,J=function(){return function(e){this.minVert=new Array(Q),this.maxVert=new Array(Q);var t=64*Q;this.buffer=new ArrayBuffer(t);var r=0;this.minProj=new Float64Array(this.buffer,r,Q),r+=8*Q,this.maxProj=new Float64Array(this.buffer,r,Q),r+=8*Q;for(var n=0;n<Q;++n)this.minVert[n]=new Float64Array(this.buffer,r,3),r+=24;for(n=0;n<Q;++n)this.maxVert[n]=new Float64Array(this.buffer,r,3),r+=24;for(n=0;n<Q;++n)this.minProj[n]=Number.POSITIVE_INFINITY,this.maxProj[n]=Number.NEGATIVE_INFINITY;var a=new Array(Q),o=new Array(Q),i=e.data,u=e.offsetIdx,s=e.strideIdx;for(n=u;n<i.length;n+=s){var c=i[n];c<this.minProj[0]&&(this.minProj[0]=c,a[0]=n),c>this.maxProj[0]&&(this.maxProj[0]=c,o[0]=n),(c=i[n+1])<this.minProj[1]&&(this.minProj[1]=c,a[1]=n),c>this.maxProj[1]&&(this.maxProj[1]=c,o[1]=n),(c=i[n+2])<this.minProj[2]&&(this.minProj[2]=c,a[2]=n),c>this.maxProj[2]&&(this.maxProj[2]=c,o[2]=n),(c=i[n]+i[n+1]+i[n+2])<this.minProj[3]&&(this.minProj[3]=c,a[3]=n),c>this.maxProj[3]&&(this.maxProj[3]=c,o[3]=n),(c=i[n]+i[n+1]-i[n+2])<this.minProj[4]&&(this.minProj[4]=c,a[4]=n),c>this.maxProj[4]&&(this.maxProj[4]=c,o[4]=n),(c=i[n]-i[n+1]+i[n+2])<this.minProj[5]&&(this.minProj[5]=c,a[5]=n),c>this.maxProj[5]&&(this.maxProj[5]=c,o[5]=n),(c=i[n]-i[n+1]-i[n+2])<this.minProj[6]&&(this.minProj[6]=c,a[6]=n),c>this.maxProj[6]&&(this.maxProj[6]=c,o[6]=n)}for(n=0;n<Q;++n){var f=a[n];y(this.minVert[n],i,f),f=o[n],y(this.maxVert[n],i,f)}}}(),K=function(){return function(){this.b0=[1,0,0],this.b1=[0,1,0],this.b2=[0,0,1],this.quality=0}}()}.apply(null,n))||(e.exports=a)}}]);