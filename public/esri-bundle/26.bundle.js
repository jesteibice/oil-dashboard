(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/layers/features/Pipeline":2133,"esri/views/2d/layers/features/support/Tile":2208,"esri/views/2d/layers/features/support/TileStore":2245,"esri/views/2d/layers/features/controllers":2400,"esri/views/2d/layers/features/processors":2401})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{2133:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(11),r(9),r(4),r(8),r(47),r(15),r(26),r(13),r(7),r(2),r(104),r(531),r(2400),r(2401),r(2245),r(810)],void 0===(i=function(e,t,r,n,i,o,s,l,a,u,c,d,p,h,f,v,y,b,m,w){Object.defineProperty(t,"__esModule",{value:!0});var g=d.getLogger("esri.views.2d.layers.features.Pipeline"),_=new Set;t.getInstances=function(){return _};var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.tileStore=null,t.service=null,t.viewState=null,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)}),c("esri-performance-tests")&&!c("esri-workers")&&_.add(this)},t.prototype.destroy=function(){c("esri-performance-tests")&&!c("esri-workers")&&_.delete(this),this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){var e=this.controller,t=this.processor;return!e||!t||e.updating||t.updating||!1},enumerable:!0,configurable:!0}),t.prototype.startup=function(e){var t=e.service,r=e.config,n=e.tileInfo;return i(this,void 0,void 0,function(){var e;return o(this,function(i){return e=new w(f.fromJSON(n)),this.service=t,this.tileStore=new m.default(e),[2,this._configure(r)]})})},t.prototype.update=function(e){var t=e.config,r=e.options;return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.processor&&this.controller?r.layerFilterChanged||r.invalidateFeatureData||r.invalidateMesh?[4,this.controller.update(t,r.layerFilterChanged)]:[3,2]:(g.error(new u("mapview-pipeline","Tried to update an unconfigured pipeline.")),[2]);case 1:e.sent(),e.label=2;case 2:return r.invalidateMesh?[4,this.processor.update(t)]:[3,4];case 3:e.sent(),this.controller.invalidate(),e.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return e.sent(),[2]}})})},t.prototype.setViewState=function(e){var t=v.fromJSON(e);this._set("viewState",t),this.tileStore&&this.tileStore.setViewState(t),this.controller&&this.controller.setViewState(t)},t.prototype._configure=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,p.all([a.safeCast(this._handleControllerConfig(e)),a.safeCast(this._handleProcessorConfig(e))])];case 1:return t.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[2]}})})},t.prototype._handleControllerConfig=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(r){switch(r.label){case 0:return[4,this._createController(this.service,e)];case 1:return[4,(t=r.sent()).startup()];case 2:return r.sent(),[2,t]}})})},t.prototype._handleProcessorConfig=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this._createProcessor(this.service,e)]})})},t.prototype._createController=function(e,t){return i(this,void 0,void 0,function(){var r,n,i,s,l;return o(this,function(o){switch(o.label){case 0:return[4,y.loadControllerModule(e.type)];case 1:return r=o.sent().default,i=(n=this).tileStore,s=n.remoteClient,l=new r({service:e,config:t,tileStore:i,remoteClient:s}),this.controller&&this.controller.destroy(),this.controller=l,[2,l]}})})},t.prototype._createProcessor=function(e,t){return i(this,void 0,void 0,function(){var r,n,i,s,l;return o(this,function(o){switch(o.label){case 0:return[4,b.loadProcessorModule(t.renderer.type)];case 1:return r=o.sent().default,i=(n=this).remoteClient,s=n.tileStore,l=new r({service:e,config:t,tileStore:s,remoteClient:i}),this.processor&&this.processor.destroy(),this.processor=l,[2,l]}})})},n([h.property()],t.prototype,"controller",void 0),n([h.property()],t.prototype,"processor",void 0),n([h.property({dependsOn:["controller.updating","processor.updating"]})],t.prototype,"updating",null),n([h.property()],t.prototype,"viewState",void 0),n([h.subclass("esri.views.2d.layers.features.Pipeline")],t)}(h.declared(l));t.default=C}.apply(null,n))||(e.exports=i)},2208:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(116),r(236),r(30),r(44),r(814),r(202)],void 0===(i=function(e,t,r,n,i,o,s,l){function a(e,t){var r=e.bounds,n=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&r[0]<=n[0]&&r[1]<=n[1]&&r[2]>=n[2]&&r[3]>=n[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=a,t.isChildOf=function(e,t){return a(t,e)};var u=function(){function e(e,t){this.bounds=o.create(),this.key=new l(0,0,0,0),this.objectIds=new r.default,this.key.set(t);var n=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extent",{get:function(){return i.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),r=n.acquire(),i=0;i<t.length;i++)r[i]=new e(this.tileInfoView,t[i]);return r},e.prototype.getQuantizationParameters=function(){return s.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=u,t.default=u}.apply(null,n))||(e.exports=i)},2245:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(0),r(116),r(50),r(26),r(830),r(2208),r(202)],void 0===(i=function(e,t,r,n,i,o,s,l,a,u){Object.defineProperty(t,"__esModule",{value:!0});var c={added:[],removed:[]},d=new i.default,p=new u(0,0,0,0),h=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=l(9,s("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileScheme=t,r}return r(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var n=t*r.resolution,i=r.bounds[0]-n,o=r.bounds[1]-n,s=r.bounds[2]+n,l=r.bounds[3]+n,a=[],u=0,c=this._index.search({minX:i,minY:o,maxX:s,maxY:l});u<c.length;u++){var d=c[u],p=d.bounds.slice();p[0]=Math.max(p[0],i),p[1]=Math.max(p[1],o),p[2]=Math.min(p[2],s),p[3]=Math.min(p[3],l),p[2]-p[0]>0&&p[3]-p[1]>0&&a.push({bounds:p,tile:d})}return a},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var r=t.spans,n=t.lodInfo,i=n.level;if(r.length>0)for(var o=0,s=r;o<s.length;o++)for(var l=s[o],u=l.row,h=l.colFrom,f=l.colTo,v=h;v<=f;v++){var y=p.set(i,u,n.normalizeCol(v),n.getWorldForColumn(v)).id;if(d.add(y),!this.has(y)){var b=new a.default(this.tileScheme,y);this._tiles.set(y,b),this._index.insert(b),this.tiles.push(b),c.added.push(b)}}for(var m=this.tiles.length-1;m>=0;m--){b=this.tiles[m];d.has(b.id)||(this._tiles.delete(b.id),this.tiles.splice(m,1),this._index.remove(b),c.removed.push(b))}(c.added.length||c.removed.length)&&this.emit("update",c),d.clear(),c.added.length=0,c.removed.length=0}},t}(o);t.default=h}.apply(null,n))||(e.exports=i)},2400:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(9),r(11),r(15),r(7)],void 0===(i=function(e,t,n,i,o,s,l){Object.defineProperty(t,"__esModule",{value:!0}),t.loadControllerModule=function(e){switch(e){case"on-demand":return l.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(14),r.e(79)]).then(function(){var t=[r(2645)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"memory":return l.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(14),r.e(62)]).then(function(){var t=[r(2651)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"stream":return l.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(14),r.e(63)]).then(function(){var t=[r(2652)];e.apply(null,t)}.bind(this)).catch(r.oe)});default:return l.reject(new s("mapview-controller:bad-type","Unable to create controller for unknown type: "+e))}}}.apply(null,n))||(e.exports=i)},2401:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4),r(7)],void 0===(i=function(e,t,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.loadProcessorModule=function(e){return"heatmap"===e?i.create(function(e){return r.e(64).then(function(){var t=[r(2658)];e.apply(null,t)}.bind(this)).catch(r.oe)}):i.create(function(e){return Promise.all([r.e(0),r.e(1),r.e(65)]).then(function(){var t=[r(2659)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}.apply(null,n))||(e.exports=i)}}]);