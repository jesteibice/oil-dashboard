(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/layers/PointCloudWorker":2122,"esri/views/3d/layers/i3s/I3SBinaryReader":2184,"esri/core/libs/gl-matrix-2/quatf32":2201,"esri/views/3d/layers/i3s/LEPCC":2209,"esri/views/3d/layers/i3s/PointCloudRendererUtil":2227,"esri/core/libs/gl-matrix-2/factories/quatf32":2246})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{2122:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(12),r(7),r(182),r(164),r(476),r(2201),r(10),r(354),r(32),r(2184),r(2209),r(2227),r(38),r.dj.m(e)],void 0===(o=function(e,t,r,n,o,i,a,u,l,f,c,s,d,y,v,p){Object.defineProperty(t,"__esModule",{value:!0});var b=function(){function e(){}return e.prototype._process=function(e){var t=this._transform(e);return n.resolve({result:t,transferList:[t.points.buffer,t.rgb.buffer]})},e.prototype._transform=function(e){var t=this.readGeometry(e.schema,e.geometryBuffer),r=t.length/3,n=y.evaluateRenderer(e.rendererInfo,e.primaryAttribute,e.modulationAttribute,t,r);e.filterInfo&&e.filterInfo.length>0&&(r=y.filterInPlace(t,n,e.filterInfo,e.filterAttributes)),3*r<n.length&&(n=new Uint8Array(n.buffer.slice(0,3*r))),this._applyElevationOffsetInPlace(t,r,e.elevationOffset);var o=this._transformCoordinates(t,r,e.obb,c.fromJSON(e.inSR),c.fromJSON(e.outSR));return{obb:e.obb,points:o,rgb:n}},e.prototype.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=s.createGeometryIndexFromSchema(t,e),n=s.createTypedView(t,r.vertexAttributes.position),o=r.header.fields,i=[o.offsetX,o.offsetY,o.offsetZ],a=[o.scaleX,o.scaleY,o.scaleZ],u=n.length/3,l=new Float64Array(3*u),f=0;f<u;f++)l[3*f]=n[3*f]*a[0]+i[0],l[3*f+1]=n[3*f+1]*a[1]+i[1],l[3*f+2]=n[3*f+2]*a[2]+i[2];return l}if("lepcc-xyz"===e.encoding)return d.decodeXYZ(t).result},e.prototype._transformCoordinates=function(e,t,r,n,o){if(!v.bufferToBuffer(e,n,0,e,o,0,t))throw Error("Can't reproject");var i=f.vec3f32.fromValues(r.center[0],r.center[1],r.center[2]),u=f.vec3f32.create(),c=f.vec3f32.create();a.quat.conjugate(g,r.quaternion);for(var s=new Float32Array(3*t),d=0;d<t;d++)u[0]=e[3*d]-i[0],u[1]=e[3*d+1]-i[1],u[2]=e[3*d+2]-i[2],l.vec3.transformQuat(c,u,g),r.halfSize[0]=Math.max(r.halfSize[0],Math.abs(c[0])),r.halfSize[1]=Math.max(r.halfSize[1],Math.abs(c[1])),r.halfSize[2]=Math.max(r.halfSize[2],Math.abs(c[2])),s[3*d]=u[0],s[3*d+1]=u[1],s[3*d+2]=u[2];return s},e.prototype._applyElevationOffsetInPlace=function(e,t,r){if(0!==r)for(var n=0;n<t;n++)e[3*n+2]+=r},e}(),g=u.quatf32.create(),h=function(t){function a(){var r=t.call(this)||this;return r._thread=void 0,i.open(o.getAbsMid("./PointCloudWorker",e,p)).then(function(e){void 0===r._thread?r._thread=e:e.close()}),r}return r(a,t),a.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},a.prototype.transform=function(e,t,r){return this._thread?this._thread.invoke("_process",e,{transferList:t,signal:r}):n.resolve(this._transform(e))},a}(b);t.PointCloudWorker=h,t.default=function(){return new b}}.apply(null,n))||(e.exports=o)},2184:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(15),r(5),r(13),r(2209)],void 0===(o=function(e,t,r,n,o,i){function a(e,t,n){for(var o="",i=0;i<n;){var a=e[t+i];if(a<128)o+=String.fromCharCode(a),i++;else if(a>=192&&a<224){if(i+1>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var u=(31&a)<<6|63&e[t+i+1];o+=String.fromCharCode(u),i+=2}else if(a>=224&&a<240){if(i+2>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");u=(15&a)<<12|(63&e[t+i+1])<<6|63&e[t+i+2];o+=String.fromCharCode(u),i+=3}else{if(!(a>=240&&a<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(i+3>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((u=(7&a)<<18|(63&e[t+i+1])<<12|(63&e[t+i+2])<<6|63&e[t+i+3])>=65536){var l=55296+(u-65536>>10),f=56320+(1023&u);o+=String.fromCharCode(l,f)}else o+=String.fromCharCode(u);i+=4}}return o}function u(e,r){for(var n={byteOffset:0,byteCount:0,fields:Object.create(null)},o=0,i=0;i<r.length;i++){var a=r[i],u=a.valueType||a.type,l=t.valueType2ArrayBufferReader[u];n.fields[a.property]=l(e,o),o+=t.valueType2TypedArrayClassMap[u].BYTES_PER_ELEMENT}return n.byteCount=o,n}function l(e,t,n){var o,i,u=[],l=0;for(i=0;i<e;i+=1){if((o=t[i])>0){if(u.push(a(n,l,o-1)),0!==n[l+o-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else u.push(null);l+=o}return u}function f(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function c(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function s(e,t,o){for(var i=null!=t.header?u(e,t.header):{byteOffset:0,byteCount:0,fields:{count:o}},a={header:i,byteOffset:i.byteCount,byteCount:0,entries:Object.create(null)},l=i.byteCount,f=0;f<t.ordering.length;f++){var c=t.ordering[f],s=n.clone(t[c]);if(s.count=i.fields.count,"String"===s.valueType){if(s.byteOffset=l,s.byteCount=i.fields[c+"ByteCount"],"UTF-8"!==s.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:s.encoding})}else{if(!y(s.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:s.valueType});var d=v(s.valueType);l+=l%d!=0?d-l%d:0,s.byteOffset=l,s.byteCount=d*s.valuesPerElement*s.count}l+=s.byteCount,a.entries[c]=s}return a.byteCount=l-a.byteOffset,a}function d(e,t,n){if(t!==e&&p.error("Invalid "+n+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function y(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function v(e){return y(e)?t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT:0}Object.defineProperty(t,"__esModule",{value:!0});var p=o.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=u,t.readStringArray=l,t.createTypedView=f,t.createRawView=c,t.createAttributeDataIndex=s,t.createGeometryIndexFromDefinition=function(e,t,r){for(var n={header:{byteOffset:0,byteCount:e.offset,fields:{}},byteOffset:e.offset,byteCount:0,vertexAttributes:{},featureAttributes:{}},o=e.offset,i=function(e,t,r,n){var i="UInt64"===t.type?8:v(t.type),a={byteOffset:o,byteCount:i*t.component*r,count:r,valueType:t.type,valuesPerElement:t.component};o+=a.byteCount,n[e]=a},a=0,u=b;a<u.length;a++){var l=u[a];e[l[0]]&&i(l[1],e[l[0]],t,n.vertexAttributes)}for(var f=0,c=g;f<c.length;f++){var s=c[f];e[s[0]]&&i(s[1],e[s[0]],r,n.featureAttributes)}return n};var b=[["position","position"],["normal","normal"],["uv0","uv0"],["uv1","uv1"],["color","color"],["uvRegion","region"]],g=[["featureId","id"],["faceRange","faceRange"]];t.createGeometryIndexFromSchema=function(e,t){for(var r=u(e,t&&t.header),o=r.byteCount,i={header:r,byteOffset:r.byteCount,byteCount:0,vertexAttributes:n.clone(t.vertexAttributes)},a=i.vertexAttributes,l=r.fields,f=null!=l.vertexCount?l.vertexCount:l.count,c=0;c<t.ordering.length;c++){var s=t.ordering[c];null!=a[s]&&(a[s].byteOffset=o,a[s].count=f,o+=v(a[s].valueType)*a[s].valuesPerElement*f)}var y=l.faceCount;if(t.faces&&y){i.faces=n.clone(t.faces);var p=i.faces;for(c=0;c<t.ordering.length;c++){var b=t.ordering[c];null!=p[b]&&(p[b].byteOffset=o,p[b].count=y,o+=v(p[b].valueType)*p[b].valuesPerElement*y)}}var g=l.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&g){i.featureAttributes=n.clone(t.featureAttributes);var h=i.featureAttributes;for(c=0;c<t.featureAttributeOrder.length;c++){var w=t.featureAttributeOrder[c];h[w].byteOffset=o,h[w].count=g;var m=v(h[w].valueType);"UInt64"===h[w].valueType&&(m=8),o+=m*h[w].valuesPerElement*g}}return d(o,e.byteLength,"geometry"),i.byteCount=o-i.byteOffset,i},t.readBinaryAttribute=function(e,t,n){if("lepcc-rgb"===e.encoding)return i.decodeRGB(t);if("lepcc-intensity"===e.encoding)return i.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(p.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(p.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var o=s(t,e,n);d(o.byteOffset+o.byteCount,t.byteLength,"attribute");var a=o.entries.attributeValues||o.entries.objectIds;if(a){if("String"===a.valueType){var u=o.entries.attributeByteCounts,y=f(t,u),v=c(t,a);return l(u.count,y,v)}return f(t,a)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=y,t.getBytesPerValue=v}.apply(null,n))||(e.exports=o)},2201:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(2246)],void 0===(o=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.quatf32=r}.apply(null,n))||(e.exports=o)},2209:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(15)],void 0===(o=function(e,t,r){function n(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+c.identifierOffset,c.identifierLength)),version:t.getUint16(r+c.versionOffset,f),checksum:t.getUint32(r+c.checksumOffset,f)}}function o(e,t){return{sizeLo:e.getUint32(t+s.sizeLo,f),sizeHi:e.getUint32(t+s.sizeHi,f),minX:e.getFloat64(t+s.minX,f),minY:e.getFloat64(t+s.minY,f),minZ:e.getFloat64(t+s.minZ,f),maxX:e.getFloat64(t+s.maxX,f),maxY:e.getFloat64(t+s.maxY,f),maxZ:e.getFloat64(t+s.maxZ,f),errorX:e.getFloat64(t+s.errorX,f),errorY:e.getFloat64(t+s.errorY,f),errorZ:e.getFloat64(t+s.errorZ,f),count:e.getUint32(t+s.count,f),reserved:e.getUint32(t+s.reserved,f)}}function i(e,t,r){var n=[];t=a(e,t,n);for(var o=[],i=0;i<n.length;i++){o.length=0,t=a(e,t,o);for(var u=0;u<o.length;u++)r.push(o[u]+n[i])}return t}function a(e,t,n){var o=new DataView(e,t),i=o.getUint8(0),a=31&i,u=!!(32&i),l=(192&i)>>6,c=0;if(0===l)c=o.getUint32(1,f),t+=5;else if(1===l)c=o.getUint16(1,f),t+=3;else{if(2!==l)throw new r("lepcc-decode-error","Bad count type");c=o.getUint8(1),t+=2}if(u)throw new r("lepcc-decode-error","LUT not implemented");for(var s=Math.ceil(c*a/8),d=new Uint8Array(e,t,s),y=0,v=0,p=0,b=-1>>>32-a,g=0;g<c;g++){for(;v<a;)y|=d[p]<<v,v+=8,p+=1;n[g]=y&b,y>>>=a,(v-=a)+a>32&&(y|=d[p-1]>>8-v)}return t+p}function u(e,t){return{sizeLo:e.getUint32(t+d.sizeLo,f),sizeHi:e.getUint32(t+d.sizeHi,f),count:e.getUint32(t+d.count,f),colorMapCount:e.getUint16(t+d.colorMapCount,f),lookupMethod:e.getUint8(t+d.lookupMethod),compressionMethod:e.getUint8(t+d.compressionMethod)}}function l(e,t){return{sizeLo:e.getUint32(t+y.sizeLo,f),sizeHi:e.getUint32(t+y.sizeHi,f),count:e.getUint32(t+y.count,f),scaleFactor:e.getUint16(t+y.scaleFactor,f),bitsPerPoint:e.getUint8(t+y.bitsPerPoint),reserved:e.getUint8(t+y.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var f=!0,c={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},s={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),a=0,u=n(e,t,a),l=u.identifier,f=u.version;if(a+=c.byteCount,"LEPCC     "!==l)throw new r("lepcc-decode-error","Bad identifier");if(f>1)throw new r("lepcc-decode-error","Unknown version");var d=o(t,a);if(a+=s.byteCount,d.sizeHi*Math.pow(2,32)+d.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var y=new Float64Array(3*d.count),v=[],p=[],b=[],g=[];if((a=i(e,a=i(e,a=i(e,a=i(e,a,v),p),b),g))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var h=0,w=0,m=0;m<v.length;m++){w+=v[m];for(var C=0,A=0;A<p[m];A++){C+=b[h];var U=g[h];y[3*h]=Math.min(d.maxX,d.minX+2*d.errorX*C),y[3*h+1]=Math.min(d.maxY,d.minY+2*d.errorY*w),y[3*h+2]=Math.min(d.maxZ,d.minZ+2*d.errorZ*U),h++}}return{errorX:d.errorX,errorY:d.errorY,errorZ:d.errorZ,result:y}};var d={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),o=0,i=n(e,t,o),a=i.identifier,l=i.version;if(o+=c.byteCount,"ClusterRGB"!==a)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var f=u(t,o);if(o+=d.byteCount,f.sizeHi*Math.pow(2,32)+f.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if((2===f.lookupMethod||1===f.lookupMethod)&&0===f.compressionMethod){if(3*f.colorMapCount+f.count+o!==e.byteLength||f.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");for(var s=new Uint8Array(e,o,3*f.colorMapCount),y=new Uint8Array(e,o+3*f.colorMapCount,f.count),v=new Uint8Array(3*f.count),p=0;p<f.count;p++){var b=y[p];v[3*p]=s[3*b],v[3*p+1]=s[3*b+1],v[3*p+2]=s[3*b+2]}return v}if(0===f.lookupMethod&&0===f.compressionMethod){if(3*f.count+o!==e.byteLength||0!==f.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,o).slice()}if(f.lookupMethod<=2&&1===f.compressionMethod){if(o+3!==e.byteLength||1!==f.colorMapCount)throw new r("lepcc-decode-error","Bad count");var g=t.getUint8(o),h=t.getUint8(o+1),w=t.getUint8(o+2);for(v=new Uint8Array(3*f.count),p=0;p<f.count;p++)v[3*p]=g,v[3*p+1]=h,v[3*p+2]=w;return v}throw new r("lepcc-decode-error","Bad method "+f.lookupMethod+","+f.compressionMethod)};var y={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),o=0,i=n(e,t,o),u=i.identifier,f=i.version;if(o+=c.byteCount,"Intensity "!==u)throw new r("lepcc-decode-error","Bad identifier");if(f>1)throw new r("lepcc-decode-error","Unknown version");var s=l(t,o);if(o+=y.byteCount,s.sizeHi*Math.pow(2,32)+s.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var d=new Uint16Array(s.count);if(8===s.bitsPerPoint){if(s.count+o!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var v=new Uint8Array(e,o,s.count),p=0;p<s.count;p++)d[p]=v[p]*s.scaleFactor}else if(16===s.bitsPerPoint){if(2*s.count+o!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=new Uint16Array(e,o,s.count),p=0;p<s.count;p++)d[p]=v[p]*s.scaleFactor}else{if(a(e,o,v=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(p=0;p<s.count;p++)d[p]=v[p]*s.scaleFactor}return d}}.apply(null,n))||(e.exports=o)},2227:function(e,t,r){var n,o;n=[r.dj.c(e.i),t,r(367),r(368),r(369),r(2184)],void 0===(o=function(e,t,r,n,o,i){function a(e){for(var t=0,r=0,n=e||[];r<n.length;r++)t|=1<<n[r];return t}function u(e,t){for(var r=0,n=e;r<n.length;r++){var o=n[r];if(o.name===t&&null!=o.attributeValues&&"UInt8"===o.attributeValues.valueType&&3===o.attributeValues.valuesPerElement)return{storageInfo:o,useElevation:!1}}return null}function l(e,t){for(var r=0,n=e;r<n.length;r++){var o=n[r];if(o.name===t){var i="embedded-elevation"===o.encoding;return{storageInfo:i?null:o,useElevation:i}}}return"elevation"===t.toLowerCase()?{storageInfo:null,useElevation:!0}:null}function f(e,t,r,n){if(e&&e.useElevation){for(var o=new Float64Array(n),a=0;a<n;a++)o[a]=r[3*a+2];return o}return e&&t?i.readBinaryAttribute(e.storageInfo,t,n):null}function c(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,n=t&&e.renderer.toJSON()||null,o=null,i=!1;"point-cloud-unique-value"===r?o=l(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?o=l(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?o=l(e.attributeStorageInfo,t.field):i="point-cloud-rgb"===r?null!=(o=u(e.attributeStorageInfo,t.field)):null!=(o=u(e.attributeStorageInfo,"RGB"));var a=null;return t&&t.colorModulation&&(a=l(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:n,isRGBRenderer:i,primaryAttribute:o,modulationAttribute:a}},t.getFilterInfo=function(e){var t=e.filters;return t?t.map(function(t){return{filterJSON:t.toJSON(),attributeInfo:l(e.attributeStorageInfo,t.field)}}):[]},t.evaluateRenderer=function(e,t,i,a,u){var l=e.rendererJSON,s=e.isRGBRenderer,d=e.primaryAttribute,y=e.modulationAttribute,v=f(d,t,a,u),p=f(y,i,a,u),b=null,g=null;if(v&&s)b=v;else if(v&&"pointCloudUniqueValueRenderer"===l.type){var h=(g=o.fromJSON(l)).colorUniqueValueInfos;b=new Uint8Array(3*u);for(var w=c(g.fieldTransformType),m=0;m<u;m++)for(var C=(I=w?w(v[m]):v[m])+"",A=0;A<h.length;A++)if(h[A].values.indexOf(C)>=0){b[3*m]=h[A].color.r,b[3*m+1]=h[A].color.g,b[3*m+2]=h[A].color.b;break}}else if(v&&"pointCloudStretchRenderer"===l.type){var U=(g=n.fromJSON(l)).stops;for(b=new Uint8Array(3*u),w=c(g.fieldTransformType),m=0;m<u;m++){var I=w?w(v[m]):v[m],M=U.length-1;if(I<U[0].value)b[3*m]=U[0].color.r,b[3*m+1]=U[0].color.g,b[3*m+2]=U[0].color.b;else if(I>=U[M].value)b[3*m]=U[M].color.r,b[3*m+1]=U[M].color.g,b[3*m+2]=U[M].color.b;else for(A=1;A<U.length;A++)if(I<U[A].value){var O=(I-U[A-1].value)/(U[A].value-U[A-1].value);b[3*m]=U[A].color.r*O+U[A-1].color.r*(1-O),b[3*m+1]=U[A].color.g*O+U[A-1].color.g*(1-O),b[3*m+2]=U[A].color.b*O+U[A-1].color.b*(1-O);break}}}else if(v&&"pointCloudClassBreaksRenderer"===l.type){var S=(g=r.fromJSON(l)).colorClassBreakInfos;for(b=new Uint8Array(3*u),w=c(g.fieldTransformType),m=0;m<u;m++)for(I=w?w(v[m]):v[m],A=0;A<S.length;A++)if(I>=S[A].minValue&&I<=S[A].maxValue){b[3*m]=S[A].color.r,b[3*m+1]=S[A].color.g,b[3*m+2]=S[A].color.b;break}}else for(b=new Uint8Array(3*u),m=0;m<b.length;m++)b[m]=255;if(p&&g&&g.colorModulation){var T=g.colorModulation.minValue,z=g.colorModulation.maxValue;for(m=0;m<u;m++){var x=(I=p[m])>=z?1:I<=T?.3:.3+.7*(I-T)/(z-T);b[3*m]=x*b[3*m],b[3*m+1]=x*b[3*m+1],b[3*m+2]=x*b[3*m+2]}}return b},t.filterInPlace=function(e,t,r,n){for(var o=e.length/3,i=n.map(function(t,n){return f(r[n].attributeInfo,t,e,o)}),u=0,l=0;l<o;l++){for(var c=!0,s=0;s<r.length&&c;s++){var d=r[s].filterJSON,y=i[s][l];switch(d.type){case"pointCloudValueFilter":var v="exclude"===d.mode;-1!==d.values.indexOf(y)===v&&(c=!1);break;case"pointCloudBitfieldFilter":var p=a(d.requiredSetBits),b=a(d.requiredClearBits);(y&p)===p&&0==(y&b)||(c=!1);break;case"pointCloudReturnFilter":for(var g=15&y,h=y>>>4&15,w=h>1,m=1===g,C=g===h,A=!1,U=0,I=d.includedReturns;U<I.length;U++){var M=I[U];if("last"===M&&C||"firstOfMany"===M&&m&&w||"lastOfMany"===M&&C&&w||"single"===M&&!w){A=!0;break}}A||(c=!1)}}c&&(e[3*u]=e[3*l],e[3*u+1]=e[3*l+1],e[3*u+2]=e[3*l+2],t[3*u]=t[3*l],t[3*u+1]=t[3*l+1],t[3*u+2]=t[3*l+2],u++)}return u},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type}}.apply(null,n))||(e.exports=o)},2246:function(e,t,r){var n,o;n=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){var e=new Float32Array(4);return e[3]=1,e},t.clone=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,n){var o=new Float32Array(4);return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o},t.createView=function(e,t){return new Float32Array(e,t,4)}}.apply(null,n))||(e.exports=o)}}]);